<!DOCTYPE html><html class="dark js-focus-visible antialiased [font-feature-settings:&#x27;ss01&#x27;]" lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/c3c652cee5f0d3cc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c3c652cee5f0d3cc.css" data-n-g=""/><link rel="preload" href="/_next/static/css/5ca09d9210f45551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5ca09d9210f45551.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-5752944655d749a0.js" defer=""></script><script src="/_next/static/chunks/framework-76d02cbefae1782a.js" defer=""></script><script src="/_next/static/chunks/main-b92974553887b4ef.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c3ea1a105fde863d.js" defer=""></script><script src="/_next/static/chunks/c727088c-1d2ac074e11cb790.js" defer=""></script><script src="/_next/static/chunks/63-78b0e34dce6c1d75.js" defer=""></script><script src="/_next/static/chunks/pages/guide/%5Bslug%5D-1a0543e7c50f8f2f.js" defer=""></script><script src="/_next/static/GR9lOBE7uMcJ1m990ZVvC/_buildManifest.js" defer=""></script><script src="/_next/static/GR9lOBE7uMcJ1m990ZVvC/_ssgManifest.js" defer=""></script><script src="/_next/static/GR9lOBE7uMcJ1m990ZVvC/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap">@font-face{font-family:'Atkinson Hyperlegible';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt43C1KxNDXMspQ1lPyU89-1h6ONRlW45G055Iu.woff) format('woff')}@font-face{font-family:'Atkinson Hyperlegible';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt93C1KxNDXMspQ1lPyU89-1h6ONRlW45G056qRdiWJ.woff) format('woff')}@font-face{font-family:'Atkinson Hyperlegible';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45GE5g.woff) format('woff')}@font-face{font-family:'Atkinson Hyperlegible';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt73C1KxNDXMspQ1lPyU89-1h6ONRlW45G8WbcNcA.woff) format('woff')}@font-face{font-family:'Atkinson Hyperlegible';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt43C1KxNDXMspQ1lPyU89-1h6ONRlW45G056IkUwCgblWmLWQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Atkinson Hyperlegible';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt43C1KxNDXMspQ1lPyU89-1h6ONRlW45G056IqUwCgblWm.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Atkinson Hyperlegible';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt93C1KxNDXMspQ1lPyU89-1h6ONRlW45G056qRdhWDTFiMF225Z2k.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Atkinson Hyperlegible';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt93C1KxNDXMspQ1lPyU89-1h6ONRlW45G056qRdhWNTFiMF225.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Atkinson Hyperlegible';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G07JIoWQeCbGWn.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Atkinson Hyperlegible';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G04pIoWQeCbA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Atkinson Hyperlegible';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt73C1KxNDXMspQ1lPyU89-1h6ONRlW45G8Wbc9eiWPRl-uFV24.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Atkinson Hyperlegible';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt73C1KxNDXMspQ1lPyU89-1h6ONRlW45G8Wbc9dCWPRl-uFQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="prose prose-slate bg-white prose-lead:text-slate-500 prose-a:font-bold prose-a:no-underline prose-a:text-sky-500 max-w-full prose-a:shadow-[inset_0_17px_0_0_var(--tw-prose-background,#fff),inset_0_calc(-1*(var(--tw-prose-underline-size,4px)+2px))_0_0_var(--tw-prose-underline,theme(colors.sky.300))] hover:prose-a:[--tw-prose-underline-size:6px] dark:prose-invert dark:bg-slate-900 dark:text-slate-400 dark:[--tw-prose-background:theme(colors.slate.900)] dark:prose-lead:text-slate-400 dark:prose-a:text-sky-400 dark:prose-a:shadow-[var(--darkProseAShadow)] dark:hover:prose-a:[--tw-prose-underline-size:3px] dark:prose-hr:border-slate-800"><div id="__next"><div class="flex h-screen w-screen flex-col justify-between scroll-smooth"><header class="not-prose sticky top-0 z-50 flex items-center justify-between space-x-6 bg-white py-3 shadow-md shadow-slate-900/5 transition duration-500 dark:shadow-none sm:space-x-10 sm:py-4 md:py-5 dark:bg-transparent"><div class="content-container-width mx-auto py-3 flex items-center justify-between space-x-6"><a class="text-base font-bold text-green-600 hover:text-indigo-900 dark:text-green-300 dark:hover:text-indigo-300 sm:text-lg" href="/">CooperTS</a><nav class="md:text-md flex space-x-5 text-sm sm:space-x-10 sm:text-sm"><a class="font-medium text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white" href="/about">About</a><a class="font-medium text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white" href="/guide">Guide</a><a class="font-medium text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white" href="/packages">Packages</a><a class="font-medium text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white" href="/examples">Examples</a><a class="group" href="https://github.com/execonline-inc/CooperTS"><span class="sr-only">CooperTS on GitHub</span><svg aria-hidden="true" viewBox="0 0 16 16" class="h-6 w-6 fill-slate-500 group-hover:fill-slate-700 dark:fill-slate-300 dark:group-hover:fill-white"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg></a></nav></div></header><main class="fixed-origin content-container-width relative mx-auto flex flex-col justify-center"><div class="py-10 md:py-16"><span class="not-prose group"><a href="/guide" aria-label="Go Back" class="dark:text-sky-400  dark:hover:text-slate-300 text-sky-500 hover:text-sky-600 text-base font-bold hover:text-sky-600 dark:hover:text-sky-500 relative transform transition"><span aria-hidden="true" class="translate-x-0 transform transition-all duration-200 group-hover:-translate-x-2"><i class="fa fas fa-arrow-left group-hover:text-amber-500"></i></span> <!-- -->Go Back<!-- --></a></span><article class="relative"><header><h1 class="font-display text-3xl tracking-tight text-slate-900 dark:text-white">CooperTS - Practical Patterns</h1></header><div class="prose prose-slate w-full lg:max-w-none prose-headings:scroll-mt-28 prose-headings:font-display prose-headings:font-normal prose-lead:text-slate-500 prose-a:font-semibold prose-a:no-underline prose-a:shadow-[var(--proseAShadow)] hover:prose-a:[--tw-prose-underline-size:6px] prose-pre:rounded-xl prose-pre:bg-slate-900 prose-pre:shadow-lg prose-pre:p-3 md:prose-pre:p-5 prose-pre:text-xs md:prose-pre:text-sm lg:prose-pre:text-base dark:prose-invert dark:text-slate-400 dark:[--tw-prose-background:theme(colors.slate.900)] dark:prose-lead:text-slate-400 dark:prose-a:text-sky-400 dark:prose-a:shadow-[var(--darkProseAShadow)] dark:hover:prose-a:[--tw-prose-underline-size:6px] dark:prose-pre:bg-slate-800/60 dark:prose-pre:shadow-none dark:prose-pre:ring-1 dark:prose-pre:ring-slate-300/10 dark:prose-hr:border-slate-800 lg:prose-headings:scroll-mt-[8.5rem]"><h1 id="elm-inspired-functional-programming-tools-in-typescript">Elm-inspired functional-programming tools in Typescript.</h1>
<h2 id="introduction">Introduction</h2>
<p>The packages in CooperTS provide many small tools for building safely with Typescript. Additionally,
we follow a consistent component-wide pattern to build safe reactive components as State Machines.
When building a component as a state machine we create four supporting modules: <a href="#types">Types</a>, <a href="#decoders">Decoders</a>, <a href="#stores">Stores</a>, and <a href="#reactions">Reactions</a>.</p>
<p>Compilers are great. Let the compiler do the work.</p>
<h2 id="details">Details</h2>
<h3 id="types">Types</h3>
<p>Types are how we model the state machine. A typical component that fetches data from an
API endpoint might have states:</p>
<ul>
<li><code>Waiting</code> - The component is waiting for some triggering event before fetching the data</li>
<li><code>Loading</code> - The component is fetching and decoding the data (see <a href="#decoders">Decoders</a> below)</li>
<li><code>Ready</code> - The component successfully fetched the data &amp; decoded the data. This state should
hold the data from the API; consequently, the type for that data is also generally defined in the
same <code>Types</code> module.</li>
<li><code>Error</code> - An error happened while fetching or decoding the data</li>
</ul>
<p>The states are implemented as a <a href="https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes-func.html#discriminated-unions">discriminated union</a>. They are abstractions that define how we
think about the state machine.</p>
<p> For example, the above states are a good way to model a page load. These types provide interfaces that we have for each of the states and the data we are receiving from the backend.</p>
<p>The Types.ts file is one of the simpler files to work on. Generally, it is good to start with it.  If the Types.ts file is very big, then it may make sense to break it into two or more files within a &quot;Types&quot; folder.</p>
<h3 id="decoders">Decoders</h3>
<p>Decoders form our anti-corruption layer. There are two facets to this responsibility: 1) validating unknown data from external sources (the backend, a web socket, a user, a cookie, etc.); and 2) transforming that data so it fits our application model (the Types).</p>
<p>Within the Types file we define the structure that we will need from the backend. In the Decoder, we verify that the JSON matches the types that we defined. These decoders are built in little pieces. For example, a decoder file might only export a single decoder (e.g. StudentsResource) which is made up of many smaller decoders defined within the file.</p>
<p><a href="https://cooperts.io/packages/resource">Our resources follow a established pattern</a>. The resource decoder consists of a payload decoder and a Links decoder. CooperTS provides one decoder for all links and a generic resource decoder. Once we create the payload decoder, we are able to combine it with the generic resource decoder to create a specific resource decoder (e.g. StudentStore &gt; Decoder.ts).</p>
<h3 id="stores">Stores</h3>
<p>Stores are Javascript classes. We use them to model our state machines. The state is marked as a Mobx Observable and the transitions as actions. The stores describe the states that our state machines can be in and the transitions that are possible between states. For example, our model for page load has the following states: Waiting, Loading, Ready, and Error. Typical transitions are named after our states. We have a &#39;loading&#39; transition that only does anything if we start from Waiting. If we trigger the  &#39;loading&#39; transition from a Ready state, nothing happens.</p>
<h3 id="reactions">Reactions</h3>
<p>We model asynchronous side-effects that are fired in response to observable state transitions through Reactions. This is how we enforce a separation of concerns between the store, which is purely business logic, and the side-effects, which typically involve lower level abstractions (e.g. http requests). This occurs when a store changes state. It has 1-2 functions. Its main function is &#39;effect.&#39; It uses a switch statement on the current state to decide what action to perform. If the current state is Loading, it hits the API and decodes the response.</p>
<h3 id="mobx">Mobx</h3>
<p>Both Reactions and Stores are <a href="https://mobx.js.org/README.html">built on Mobx</a>. Mobx is our state manager library that makes it effortless to respond to state changes. It&#39;s an alternative to using React Native&#39;s state. &quot;Anything that can be derived from the application state, should be. Automatically.&quot;</p>
</div></article></div></main><div class="fixed bottom-0 right-0 z-[10000] flex h-auto w-auto items-center justify-center p-1  text-sm font-bold text-white dark:text-slate-900 rounded-full bg-slate-800 sm:bg-red-900 md:bg-blue-800 lg:bg-green-800 xl:bg-amber-600"><div class="inline-flex sm:hidden">xs (default)</div><div class="hidden sm:inline-flex md:hidden">SM</div><div class="hidden md:inline-flex lg:hidden">MD</div><div class="hidden lg:inline-flex xl:hidden">LG</div><div class="hidden xl:inline-flex">XL</div></div><footer class="not-prose sticky top-0 z-50 
        flex flex-wrap items-center justify-between
        bg-white
        py-5 px-4 shadow-md
        shadow-slate-900/5 
        dark:bg-slate-900/95 dark:shadow-none
        sm:px-6 lg:px-8" aria-label="footer"><p>Â© <!-- -->2022 <!-- --><a href="https://www.execonline.com/" target="_blank" rel="noopener noreferrer">ExecOnline</a></p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"page":{"slug":"practical-patterns","frontmatter":{"title":"CooperTS - Practical Patterns","description":"Patterns we use at ExecOnline"},"markdown":{"content":"\n# Elm-inspired functional-programming tools in Typescript.\n\n## Introduction\nThe packages in CooperTS provide many small tools for building safely with Typescript. Additionally,\nwe follow a consistent component-wide pattern to build safe reactive components as State Machines.\nWhen building a component as a state machine we create four supporting modules: [Types](#types), [Decoders](#decoders), [Stores](#stores), and [Reactions](#reactions).\n\nCompilers are great. Let the compiler do the work.\n\n## Details\n\n### Types\nTypes are how we model the state machine. A typical component that fetches data from an\nAPI endpoint might have states:\n\n- `Waiting` - The component is waiting for some triggering event before fetching the data\n- `Loading` - The component is fetching and decoding the data (see [Decoders](#decoders) below)\n- `Ready` - The component successfully fetched the data \u0026 decoded the data. This state should\n  hold the data from the API; consequently, the type for that data is also generally defined in the\n  same `Types` module.\n- `Error` - An error happened while fetching or decoding the data\n\nThe states are implemented as a [discriminated union]. They are abstractions that define how we\nthink about the state machine.\n\n[discriminated union]: https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes-func.html#discriminated-unions\n\n For example, the above states are a good way to model a page load. These types provide interfaces that we have for each of the states and the data we are receiving from the backend.\n\nThe Types.ts file is one of the simpler files to work on. Generally, it is good to start with it.  If the Types.ts file is very big, then it may make sense to break it into two or more files within a \"Types\" folder.\n\n### Decoders\n\nDecoders form our anti-corruption layer. There are two facets to this responsibility: 1) validating unknown data from external sources (the backend, a web socket, a user, a cookie, etc.); and 2) transforming that data so it fits our application model (the Types).\n\nWithin the Types file we define the structure that we will need from the backend. In the Decoder, we verify that the JSON matches the types that we defined. These decoders are built in little pieces. For example, a decoder file might only export a single decoder (e.g. StudentsResource) which is made up of many smaller decoders defined within the file.\n\n[Our resources follow a established pattern]. The resource decoder consists of a payload decoder and a Links decoder. CooperTS provides one decoder for all links and a generic resource decoder. Once we create the payload decoder, we are able to combine it with the generic resource decoder to create a specific resource decoder (e.g. StudentStore \u003e Decoder.ts).\n\n[Our resources follow a established pattern]: https://cooperts.io/packages/resource\n\n### Stores\n\nStores are Javascript classes. We use them to model our state machines. The state is marked as a Mobx Observable and the transitions as actions. The stores describe the states that our state machines can be in and the transitions that are possible between states. For example, our model for page load has the following states: Waiting, Loading, Ready, and Error. Typical transitions are named after our states. We have a 'loading' transition that only does anything if we start from Waiting. If we trigger the  'loading' transition from a Ready state, nothing happens.\n\n### Reactions\n\nWe model asynchronous side-effects that are fired in response to observable state transitions through Reactions. This is how we enforce a separation of concerns between the store, which is purely business logic, and the side-effects, which typically involve lower level abstractions (e.g. http requests). This occurs when a store changes state. It has 1-2 functions. Its main function is 'effect.' It uses a switch statement on the current state to decide what action to perform. If the current state is Loading, it hits the API and decodes the response.\n\n### Mobx\n\nBoth Reactions and Stores are [built on Mobx]. Mobx is our state manager library that makes it effortless to respond to state changes. It's an alternative to using React Native's state. \"Anything that can be derived from the application state, should be. Automatically.\"\n\n[built on Mobx]: https://mobx.js.org/README.html\n"}},"navTree":[{"title":"Guide","links":[{"title":"Maybe Adapter","href":"/guide/maybe"},{"title":"CooperTS - Practical Patterns","href":"/guide/practical-patterns"},{"title":"Translations Package","href":"/guide/translations"}]},{"title":"Packages","links":[{"title":"ajaxian","href":"/packages/ajaxian"},{"title":"ajaxios","href":"/packages/ajaxios"},{"title":"@kofno/cute","href":"/packages/cute"},{"title":"@kofno/gaia","href":"/packages/gaia"},{"title":"jsonous","href":"/packages/jsonous"},{"title":"maybeasy","href":"/packages/maybeasy"},{"title":"nonempty-list","href":"/packages/nonempty-list"},{"title":"@kofno/piper","href":"/packages/piper"},{"title":"resulty","href":"/packages/resulty"},{"title":"@kofno/stack-ts","href":"/packages/stack-ts"},{"title":"taskarian","href":"/packages/taskarian"},{"title":"@execonline-inc/appy","href":"/packages/appy"},{"title":"@execonline-inc/collections","href":"/packages/collections"},{"title":"@execonline-inc/decoders","href":"/packages/decoders"},{"title":"@execonline-inc/dom","href":"/packages/dom"},{"title":"@execonline-inc/environment","href":"/packages/environment"},{"title":"@execonline-inc/error-handling","href":"/packages/error-handling"},{"title":"@execonline-inc/logging","href":"/packages/logging"},{"title":"@execonline-inc/maybe-adapter","href":"/packages/maybe-adapter"},{"title":"@execonline-inc/numbers","href":"/packages/numbers"},{"title":"@execonline-inc/resource","href":"/packages/resource"},{"title":"@execonline-inc/strings","href":"/packages/strings"},{"title":"@execonline-inc/time","href":"/packages/time"},{"title":"@execonline-inc/time-distance","href":"/packages/time-distance"},{"title":"@execonline-inc/translations","href":"/packages/translations"},{"title":"@execonline-inc/url","href":"/packages/url"}]}]},"__N_SSG":true},"page":"/guide/[slug]","query":{"slug":"practical-patterns"},"buildId":"GR9lOBE7uMcJ1m990ZVvC","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>